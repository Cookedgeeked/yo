2025.11.13

-MySQLは外部にopenで外から接続できるパターンと、内部local host内に閉じているパターンがある
-[webアプリのソースコード]そのアプリを作って動かしているすべてのプログラムの中身をまとめたもの
　front end HTML,CSS,JAvaScript(ボタンのアニメーション）
　back end Python,PHP,Ruby,Node.js,Java(大規模システム、androidアプリ）
　設定ファイル
-congif.php アプリ全体の心臓の鼓動を決めるスイッチ板、アプリがどのデータベースを使うか、サイト名、URL,管理者メールアドレス、タイムゾーン、暗号キー、パスワード、ハッシュ設定



<?php
$file=$_GET['file'];
include($file. '.php');
?>

phpは意図、処理、HTMLは物質化、画面
サーバーが処理して」HTML作ってブラウザに
HTMLを生み出す、サーバー側の仕組み
HTML＝肉体　CSS＝服、JavaScript＝肉体の動き、感情的動き
PHP＝魂の意志、
WEBページを動かすための言語
役割：フォームの入力を受け取る、処理する、（ログインとかで）
　　　データベースと連携する、MYSQLとつないで
　　　ユーザー情報や記事などを保存、表示
　　　SNSなど毎回内容が変わる動きを記録、制御
WORDPRESSはPHPで書かれている、会員サイト、ショッピングサイト


- <? PHPコードの最初の合図
- $file=$_GET['file'];
-$file $で始まるのは変数
ここでは受け取った情報を一時的に置いておく箱みたいなもの

-$_GET phpが最初から用意しているスーパーグローバル変数の一つ（どこからでも使える、関数、ファイルの中でも直接アクセスできる
←→作った場所でしか使えない）
　　　URLの？以降の情報を取得、GETはHTTPメソッドのGETからデータを取得したいときに使う方法、→GETリクエストで送られてきたデータを保持する箱
- parameter ギリシャ語、para に沿って、metron 基準、測る、⇒基準に沿って測るもの、結果を決める目安、何か評価したり図るためのものさし、⇒その目安に従って、結果や動きを調整する、つまみみたいなもの、つまみ回すと、現実が少しずつ変わる、
ex 電子レンジ　1分→半生　２分→温かい　３分→熱い　時間という目安で出来上がりを調整してる
　webサイト　　?page=2 →２ページ目を表示　page=2がパラメータ　ページどれにするか決める目安
　ゲームキャラ　HP＝100 攻撃力＝50 それぞれの値がパラメータ　キャラの強さを決める目安
　エアコン　　　25℃→涼しくなる　28℃→少し暖かくなる　温度がパラメータ

基準自体が目安みたいなもの→基準、決めた数字に沿って現実を変化させるエネルギー
-URLパラメータ　このページの動きを決める外からの指示、サーバーに向かって送る小さな指令、WEBページに渡す追加情報のこと、URLの？以降に書かれる　　サーバーは「パラメータの塊をPHPに渡す係」で、実際に$_GETで「値として読み取る」作業はPHPがやってる。
　　　ex https://example.com/page.php?file=about&color=red    file=about 表示するファイルを指定、color=red色を赤に設定
　　　　$file=$_GET['file'];
        $color=$_GET['color'];
-URLとPHPの関係
　１ユーザーがブラウザでURLを開く
　２WEBサーバーが該当する実行する側のPHPファイルを探す
　３PHPがURLパラメータを受け取り、処理する
　４結果としてHTMLページを作り、ブラウザに返す


実行を行う側のPHPファイルを探すのがサーバーで、実行されるPHPファイルを探すのが実行する側のPHPファイルってこと



$_GET 　- URLの?以降に書かれた情報（URLパラメータ）を全部持ってる辞書
['file']  - $_GETという辞書から'file'というキーワードに対応する値（URLに書いてある指定した）を取り出す、この場合は'about'が返ってくる
＝　 -  取り出した値、'about'を$fileに代入する　$fileという箱に aboutが入る感じ

include($file .'.php');  - $fileに.phpをくっつけて、（.は文字をつなぐ記号）そのファイルを読み込んで実行する
$file='about'ならinclude["about.php"];となってそのファイルの中身が実行される⇒呼び出された名前のPHPファイルを取り込むという命令

$_GET['file']は外の世界（ＵＲＬ）からエネルギーを受け取る窓口
include()はそのエネルギーに対応するファイル（現実）をサーバー内から呼び込む

全体として、このPHPコードは「URLの波動によって読み込む現実を変えるポータル（門、入り口）」みたいな存在
porta ラテン語入口、ポータルは異なる世界、情報にアクセスするゲート、サーバーが現実を作り、ブラウザに返す

$_POST フォームなどからおくられてきたデータを取得、フォームなどの本文に隠れて送られるデータを受け取る
$_GET GETリクエストで送られてきたデータを保持する箱、URLには表示される
どちらもユーザー入力を受け取る点は同じ

include(...)

PHP の言語構成要素（language construct）。指定したファイルをサーバ側で読み込み、もしそのファイルに PHP タグがあればその中のコードを実行する。ない部分はそのまま出力される

include($file. '.php') $fileの後ろに強制的に.phpをつける、意図しないテキストファイルが取り出されるりすくが減る、セキュリティ安定

php実行→phpは処理される→phpは出ない
php://filter →phpタグなし→php処理されない→phpがエンコードされた形ででる

php://filter できた背景　ファイル、文字列読み書きするだけでなく、その内容を加工したり、変換したりしたい場合が多い
文字コード変換、圧縮解凍、暗号化、エンコード　フィルター通すだけで自動加工される

直接/login.php →phpは実行され、HTMLだけ出力
フィルター　page=php://filter../login.php  base64文字列かphpタグも文字列化、phpコードとして実行されず、そのまま文字列として出力

どれくらいまずいか　config.phpファイル　DB、パスワード漏洩

パス解決　引数はデフォルトではラッパー（php://),絶対パス、相対パス使える

include   load + execute+output 

LFI(local FIle Inclusion) サーバー内ファイル＋取り込む
　　　　　ユーザー入力を検証せずにそのままinclude()に（外部に）渡す、コード箇所のこと、隙

php://filter テクニックではfileパラメーターに
php://filter/convert.base64-encode/resource=<ファイルパス>

$_COOKIE PHPでブラウザ側に保存された情報（クッキー）を読み込むスーパーグローバル変数
lang language ラベルの意味：前回ユーザーが選んだ言語　jap,eng や設定をサーバーが読み取れる

include("lang/" .$_COOKIE['lang']);

("lang/".$_COOKIE['lang']) — 引数全体,include に渡す 文字列（パス）をここで作る

cookieの入れ替えをしたいから、今回はURL（GETのとき）の書き換えじゃなくて、BURPでの書き換えなのか

$_COOKIE['lang']の値に応じてファイルを読み込む
PHPはそのまま読み込みに行く、ラベル名がlangだとか、変数がcookieだと関係なく

"lang/"

ダブルクオートのリテラル文字列。スラッシュ（/）はディレクトリ区切り。"lang/" は 相対パスの先頭部分


「リテラル文字列（literal string）」とは、実行するたびに変わらない固定された文字列。

リテラル文字列 "lang/"  コードに直接書かれた固定文字列      
変数     `$lang`        実行時に中身が変わる            
式（連結）"lang/".$lang　固定文字列＋変数の組み合わせ（結果は動的） 

PHPでのリテラルの書き方
ダブルクオート　"..." → 変数展開（例: `"Hello $name"`）
シングルクオート'...' → 完全固定（変数展開しない）

lang/" . $_COOKIE['lang'] により "lang/ユーザ入力" という単一のパス文字列が作られる
lang/../upload/xxx.png は 普通 wwwroot/upload/xxx.png に解決される。wwwroot/lang/upload/... にはならない。include("lang/".$_COOKIE['lang']); に ../upload/xxx.png を入れると文字列結合で "lang/../upload/xxx.png" になる。
..親ディレクトリに行くから

['lang']（配列アクセス）

$_COOKIE 配列のキー lang を参照する。例えばブラウザが Cookie: lang=ja.lang.php を送れば $_COOKIE['lang'] は "ja.lang.php" になる

Langは確かに言語の略だけど関係ない、include の基礎、すぐ基礎が大事


C:\inetpub\wwwroot\
├── index.php
├── lang\
│   ├── ja.lang.php
│   └── en.lang.php
└── upload\
    ├── user1.png
    └── shell.php
Webサーバー（例：Apache、IIS、Nginxなど）は、どのフォルダを「ウェブの入口」として使うかを設定する。その入口が wwwroot というフォルダ名であることが多い

評価の実際の流れ（例を使って）
ブラウザが Cookie: lang=../upload/shell.php を送る。
PHP が $_COOKIE['lang'] を読み取り → '../upload/shell.php'
"lang/" . $_COOKIE['lang'] が評価され → 'lang/../upload/shell.php'
Langという文字に惑わされないこと



